(function(){console.log("Yeah! The dashboard has started!"),Dashing.on("ready",function(){var contentWidth;return Dashing.widget_margins||(Dashing.widget_margins=[7,2]),Dashing.widget_base_dimensions||(Dashing.widget_base_dimensions=[145,119]),Dashing.numColumns||(Dashing.numColumns=14),contentWidth=(Dashing.widget_base_dimensions[0]+2*Dashing.widget_margins[0])*Dashing.numColumns,Batman.setImmediate($(window).width()>768?function(){return $(".gridster").width(contentWidth),$(".gridster > ul").gridster({widget_margins:Dashing.widget_margins,widget_base_dimensions:Dashing.widget_base_dimensions,avoid_overlapped_widgets:!Dashing.customGridsterLayout,draggable:{stop:Dashing.showGridsterInstructions,start:function(){return Dashing.currentWidgetPositions=Dashing.getWidgetPositions()}}})}:function(){return $(".gridster").width(contentWidth),$(".gridster > ul").gridster({widget_margins:Dashing.widget_margins,widget_base_dimensions:Dashing.widget_base_dimensions,avoid_overlapped_widgets:!Dashing.customGridsterLayout,draggable:{stop:Dashing.showGridsterInstructions,start:function(){return Dashing.currentWidgetPositions=Dashing.getWidgetPositions()}}})})})}).call(this),function(){console.log("Yeah! The dashboard has started!"),Dashing.on("ready",function(){var contentWidth;return Dashing.widget_margins||(Dashing.widget_margins=[5,5]),Dashing.widget_base_dimensions||(Dashing.widget_base_dimensions=[300,360]),Dashing.numColumns||(Dashing.numColumns=4),contentWidth=(Dashing.widget_base_dimensions[0]+2*Dashing.widget_margins[0])*Dashing.numColumns,Batman.setImmediate(function(){return $(".gridster").width(contentWidth),$(".gridster ul:first").gridster({widget_margins:Dashing.widget_margins,widget_base_dimensions:Dashing.widget_base_dimensions,avoid_overlapped_widgets:!Dashing.customGridsterLayout,draggable:{stop:Dashing.showGridsterInstructions,start:function(){return Dashing.currentWidgetPositions=Dashing.getWidgetPositions()}}})})})}.call(this),function($){function Coords(obj){return obj[0]&&$.isPlainObject(obj[0])?this.data=obj[0]:this.el=obj,this.isCoords=!0,this.coords={},this.init(),this}var fn=Coords.prototype;fn.init=function(){this.set(),this.original_coords=this.get()},fn.set=function(update,not_update_offsets){var el=this.el;if(el&&!update&&(this.data=el.offset(),this.data.width=el.width(),this.data.height=el.height()),el&&update&&!not_update_offsets){var offset=el.offset();this.data.top=offset.top,this.data.left=offset.left}var d=this.data;return this.coords.x1=d.left,this.coords.y1=d.top,this.coords.x2=d.left+d.width,this.coords.y2=d.top+d.height,this.coords.cx=d.left+d.width/2,this.coords.cy=d.top+d.height/2,this.coords.width=d.width,this.coords.height=d.height,this.coords.el=el||!1,this},fn.update=function(data){if(!data&&!this.el)return this;if(data){var new_data=$.extend({},this.data,data);return this.data=new_data,this.set(!0,!0)}return this.set(!0),this},fn.get=function(){return this.coords},$.fn.coords=function(){if(this.data("coords"))return this.data("coords");var ins=new Coords(this,arguments[0]);return this.data("coords",ins),ins}}(jQuery,window,document),function($,window,document){function Collision(el,colliders,options){this.options=$.extend(defaults,options),this.$element=el,this.last_colliders=[],this.last_colliders_coords=[],"string"==typeof colliders||colliders instanceof jQuery?this.$colliders=$(colliders,this.options.colliders_context).not(this.$element):this.colliders=$(colliders),this.init()}var defaults={colliders_context:document.body},fn=Collision.prototype;fn.init=function(){this.find_collisions()},fn.overlaps=function(a,b){var x=!1,y=!1;return(b.x1>=a.x1&&b.x1<=a.x2||b.x2>=a.x1&&b.x2<=a.x2||a.x1>=b.x1&&a.x2<=b.x2)&&(x=!0),(b.y1>=a.y1&&b.y1<=a.y2||b.y2>=a.y1&&b.y2<=a.y2||a.y1>=b.y1&&a.y2<=b.y2)&&(y=!0),x&&y},fn.detect_overlapping_region=function(a,b){var regionX="",regionY="";return a.y1>b.cy&&a.y1<b.y2&&(regionX="N"),a.y2>b.y1&&a.y2<b.cy&&(regionX="S"),a.x1>b.cx&&a.x1<b.x2&&(regionY="W"),a.x2>b.x1&&a.x2<b.cx&&(regionY="E"),regionX+regionY||"C"},fn.calculate_overlapped_area_coords=function(a,b){var x1=Math.max(a.x1,b.x1),y1=Math.max(a.y1,b.y1),x2=Math.min(a.x2,b.x2),y2=Math.min(a.y2,b.y2);return $({left:x1,top:y1,width:x2-x1,height:y2-y1}).coords().get()},fn.calculate_overlapped_area=function(coords){return coords.width*coords.height},fn.manage_colliders_start_stop=function(new_colliders_coords,start_callback,stop_callback){for(var last=this.last_colliders_coords,i=0,il=last.length;il>i;i++)-1===$.inArray(last[i],new_colliders_coords)&&start_callback.call(this,last[i]);for(var j=0,jl=new_colliders_coords.length;jl>j;j++)-1===$.inArray(new_colliders_coords[j],last)&&stop_callback.call(this,new_colliders_coords[j])},fn.find_collisions=function(player_data_coords){for(var self=this,colliders_coords=[],colliders_data=[],$colliders=this.colliders||this.$colliders,count=$colliders.length,player_coords=self.$element.coords().update(player_data_coords||!1).get();count--;){var $collider=self.$colliders?$($colliders[count]):$colliders[count],$collider_coords_ins=$collider.isCoords?$collider:$collider.coords(),collider_coords=$collider_coords_ins.get(),overlaps=self.overlaps(player_coords,collider_coords);if(overlaps){var region=self.detect_overlapping_region(player_coords,collider_coords);if("C"===region){var area_coords=self.calculate_overlapped_area_coords(player_coords,collider_coords),area=self.calculate_overlapped_area(area_coords),collider_data={area:area,area_coords:area_coords,region:region,coords:collider_coords,player_coords:player_coords,el:$collider};self.options.on_overlap&&self.options.on_overlap.call(this,collider_data),colliders_coords.push($collider_coords_ins),colliders_data.push(collider_data)}}}return(self.options.on_overlap_stop||self.options.on_overlap_start)&&this.manage_colliders_start_stop(colliders_coords,self.options.on_overlap_stop,self.options.on_overlap_start),this.last_colliders_coords=colliders_coords,colliders_data},fn.get_closest_colliders=function(player_data_coords){var colliders=this.find_collisions(player_data_coords);return colliders.sort(function(a,b){return"C"===a.region&&"C"===b.region?a.coords.y1<b.coords.y1||a.coords.x1<b.coords.x1?-1:1:a.area<b.area?1:1}),colliders},$.fn.collision=function(collider,options){return new Collision(this,collider,options)}}(jQuery,window,document),function(window){window.debounce=function(func,wait,immediate){var timeout;return function(){var context=this,args=arguments,later=function(){timeout=null,immediate||func.apply(context,args)};immediate&&!timeout&&func.apply(context,args),clearTimeout(timeout),timeout=setTimeout(later,wait)}},window.throttle=function(func,wait){var context,args,timeout,throttling,more,result,whenDone=debounce(function(){more=throttling=!1},wait);return function(){context=this,args=arguments;var later=function(){timeout=null,more&&func.apply(context,args),whenDone()};return timeout||(timeout=setTimeout(later,wait)),throttling?more=!0:result=func.apply(context,args),whenDone(),throttling=!0,result}}}(window),function($,window,document){function Draggable(el,options){this.options=$.extend({},defaults,options),this.$body=$(document.body),this.$container=$(el),this.$dragitems=$(this.options.items,this.$container),this.is_dragging=!1,this.player_min_left=0+this.options.offset_left,this.init()}var defaults={items:".gs_w",distance:1,limit:!0,offset_left:0,autoscroll:!0,ignore_dragging:["INPUT","TEXTAREA","SELECT","BUTTON"],handle:null},$window=$(window),isTouch=!!("ontouchstart"in window),pointer_events={start:isTouch?"touchstart":"mousedown.draggable",move:isTouch?"touchmove":"mousemove.draggable",end:isTouch?"touchend":"mouseup.draggable"},fn=Draggable.prototype;fn.init=function(){this.calculate_positions(),this.$container.css("position","relative"),this.disabled=!1,this.events(),this.on_window_resize=throttle($.proxy(this.calculate_positions,this),200),$(window).bind("resize",this.on_window_resize)},fn.events=function(){this.proxied_on_select_start=$.proxy(this.on_select_start,this),this.$container.on("selectstart",this.proxied_on_select_start),this.proxied_drag_handler=$.proxy(this.drag_handler,this),this.$container.on(pointer_events.start,this.options.items,this.proxied_drag_handler),this.proxied_pointer_events_end=$.proxy(function(e){this.is_dragging=!1,this.disabled||(this.$body.off(pointer_events.move),this.drag_start&&this.on_dragstop(e))},this),this.$body.on(pointer_events.end,this.proxied_pointer_events_end)},fn.get_actual_pos=function($el){var pos=$el.position();return pos},fn.get_mouse_pos=function(e){if(isTouch){var oe=e.originalEvent;e=oe.touches.length?oe.touches[0]:oe.changedTouches[0]}return{left:e.clientX,top:e.clientY}},fn.get_offset=function(e){e.preventDefault();var mouse_actual_pos=this.get_mouse_pos(e),diff_x=Math.round(mouse_actual_pos.left-this.mouse_init_pos.left),diff_y=Math.round(mouse_actual_pos.top-this.mouse_init_pos.top),left=Math.round(this.el_init_offset.left+diff_x-this.baseX),top=Math.round(this.el_init_offset.top+diff_y-this.baseY+this.scrollOffset);return this.options.limit&&(left>this.player_max_left?left=this.player_max_left:left<this.player_min_left&&(left=this.player_min_left)),{left:left,top:top,mouse_left:mouse_actual_pos.left,mouse_top:mouse_actual_pos.top}},fn.manage_scroll=function(offset){var nextScrollTop,scrollTop=$window.scrollTop(),min_window_y=scrollTop,max_window_y=min_window_y+this.window_height,mouse_down_zone=max_window_y-50,mouse_up_zone=min_window_y+50,abs_mouse_top=(offset.mouse_left,min_window_y+offset.mouse_top),max_player_y=this.doc_height-this.window_height+this.player_height;abs_mouse_top>=mouse_down_zone&&(nextScrollTop=scrollTop+30,max_player_y>nextScrollTop&&($window.scrollTop(nextScrollTop),this.scrollOffset=this.scrollOffset+30)),mouse_up_zone>=abs_mouse_top&&(nextScrollTop=scrollTop-30,nextScrollTop>0&&($window.scrollTop(nextScrollTop),this.scrollOffset=this.scrollOffset-30))},fn.calculate_positions=function(){this.window_height=$window.height()},fn.drag_handler=function(e){e.target.nodeName;if(!this.disabled&&(1===e.which||isTouch)&&!this.ignore_drag(e)){var self=this,first=!0;return this.$player=$(e.currentTarget),this.el_init_pos=this.get_actual_pos(this.$player),this.mouse_init_pos=this.get_mouse_pos(e),this.offsetY=this.mouse_init_pos.top-this.el_init_pos.top,this.on_pointer_events_move=function(mme){var mouse_actual_pos=self.get_mouse_pos(mme),diff_x=Math.abs(mouse_actual_pos.left-self.mouse_init_pos.left),diff_y=Math.abs(mouse_actual_pos.top-self.mouse_init_pos.top);return diff_x>self.options.distance||diff_y>self.options.distance?first?(first=!1,self.on_dragstart.call(self,mme),!1):(self.is_dragging===!0&&self.on_dragmove.call(self,mme),!1):!1},this.$body.on(pointer_events.move,this.on_pointer_events_move),!1}},fn.on_dragstart=function(e){e.preventDefault(),this.drag_start=!0,this.is_dragging=!0;var offset=this.$container.offset();return this.baseX=Math.round(offset.left),this.baseY=Math.round(offset.top),this.doc_height=$(document).height(),"clone"===this.options.helper?(this.$helper=this.$player.clone().appendTo(this.$container).addClass("helper"),this.helper=!0):this.helper=!1,this.scrollOffset=0,this.el_init_offset=this.$player.offset(),this.player_width=this.$player.width(),this.player_height=this.$player.height(),this.player_max_left=this.$container.width()-this.player_width+this.options.offset_left,this.options.start&&this.options.start.call(this.$player,e,{helper:this.helper?this.$helper:this.$player}),!1},fn.on_dragmove=function(e){var offset=this.get_offset(e);this.options.autoscroll&&this.manage_scroll(offset),(this.helper?this.$helper:this.$player).css({position:"absolute",left:offset.left,top:offset.top});var ui={position:{left:offset.left,top:offset.top}};return this.options.drag&&this.options.drag.call(this.$player,e,ui),!1},fn.on_dragstop=function(e){var offset=this.get_offset(e);this.drag_start=!1;var ui={position:{left:offset.left,top:offset.top}};return this.options.stop&&this.options.stop.call(this.$player,e,ui),this.helper&&this.$helper.remove(),!1},fn.on_select_start=function(e){return this.disabled||this.ignore_drag(e)?void 0:!1},fn.enable=function(){this.disabled=!1},fn.disable=function(){this.disabled=!0},fn.destroy=function(){this.disable(),this.$container.off("selectstart",this.proxied_on_select_start),this.$container.off(pointer_events.start,this.proxied_drag_handler),this.$body.off(pointer_events.end,this.proxied_pointer_events_end),this.$body.off(pointer_events.move,this.on_pointer_events_move),$(window).unbind("resize",this.on_window_resize),$.removeData(this.$container,"drag")},fn.ignore_drag=function(event){return this.options.handle?!$(event.target).is(this.options.handle):$.inArray(event.target.nodeName,this.options.ignore_dragging)>=0},$.fn.drag=function(options){return this.each(function(){$.data(this,"drag")||$.data(this,"drag",new Draggable(this,options))})}}(jQuery,window,document),function($,window,document){function Gridster(el,options){this.options=$.extend(!0,defaults,options),this.$el=$(el),this.$wrapper=this.$el.parent(),this.$widgets=this.$el.children(this.options.widget_selector).addClass("gs_w"),this.widgets=[],this.$changed=$([]),this.wrapper_width=this.$wrapper.width(),this.min_widget_width=2*this.options.widget_margins[0]+this.options.widget_base_dimensions[0],this.min_widget_height=2*this.options.widget_margins[1]+this.options.widget_base_dimensions[1],this.init()}var defaults={namespace:"",widget_selector:"li",widget_margins:[10,10],widget_base_dimensions:[400,225],extra_rows:0,extra_cols:0,min_cols:1,min_rows:15,max_size_x:6,autogenerate_stylesheet:!0,avoid_overlapped_widgets:!0,serialize_params:function($w,wgd){return{col:wgd.col,row:wgd.row,size_x:wgd.size_x,size_y:wgd.size_y}},collision:{},draggable:{distance:4}};Gridster.generated_stylesheets=[];var fn=Gridster.prototype;fn.init=function(){this.generate_grid_and_stylesheet(),this.get_widgets_from_DOM(),this.set_dom_grid_height(),this.$wrapper.addClass("ready"),this.draggable(),this.on_window_resize=throttle($.proxy(this.recalculate_faux_grid,this),200),$(window).bind("resize",this.on_window_resize)},fn.disable=function(){return this.$wrapper.find(".player-revert").removeClass("player-revert"),this.drag_api.disable(),this},fn.enable=function(){return this.drag_api.enable(),this},fn.add_widget=function(html,size_x,size_y,col,row){var pos;size_x||(size_x=1),size_y||(size_y=1),!col&!row?pos=this.next_position(size_x,size_y):(pos={col:col,row:row},this.empty_cells(col,row,size_x,size_y));var $w=$(html).attr({"data-col":pos.col,"data-row":pos.row,"data-sizex":size_x,"data-sizey":size_y}).addClass("gs_w").appendTo(this.$el).hide();return this.$widgets=this.$widgets.add($w),this.register_widget($w),this.add_faux_rows(pos.size_y),this.set_dom_grid_height(),$w.fadeIn()},fn.resize_widget=function($widget,size_x,size_y){var wgd=$widget.coords().grid;size_x||(size_x=wgd.size_x),size_y||(size_y=wgd.size_y),size_x>this.cols&&(size_x=this.cols);var old_cells_occupied=this.get_cells_occupied(wgd),old_size_x=wgd.size_x,old_size_y=wgd.size_y,old_col=wgd.col,new_col=old_col;if(old_col+size_x-1>this.cols){var diff=old_col+(size_x-1)-this.cols,c=old_col-diff;new_col=Math.max(1,c)}var new_grid_data={col:new_col,row:wgd.row,size_x:size_x,size_y:size_y},new_cells_occupied=this.get_cells_occupied(new_grid_data),empty_cols=[];$.each(old_cells_occupied.cols,function(i,col){-1===$.inArray(col,new_cells_occupied.cols)&&empty_cols.push(col)});var occupied_cols=[];$.each(new_cells_occupied.cols,function(i,col){-1===$.inArray(col,old_cells_occupied.cols)&&occupied_cols.push(col)});var empty_rows=[];$.each(old_cells_occupied.rows,function(i,row){-1===$.inArray(row,new_cells_occupied.rows)&&empty_rows.push(row)});var occupied_rows=[];if($.each(new_cells_occupied.rows,function(i,row){-1===$.inArray(row,old_cells_occupied.rows)&&occupied_rows.push(row)}),this.remove_from_gridmap(wgd),occupied_cols.length){var cols_to_empty=[new_col,wgd.row,size_x,Math.min(old_size_y,size_y),$widget];this.empty_cells.apply(this,cols_to_empty)}if(occupied_rows.length){var rows_to_empty=[new_col,wgd.row,size_x,size_y,$widget];this.empty_cells.apply(this,rows_to_empty)}if(wgd.col=new_col,wgd.size_x=size_x,wgd.size_y=size_y,this.add_to_gridmap(new_grid_data,$widget),$widget.data("coords").update({width:size_x*this.options.widget_base_dimensions[0]+(size_x-1)*this.options.widget_margins[0]*2,height:size_y*this.options.widget_base_dimensions[1]+(size_y-1)*this.options.widget_margins[1]*2}),size_y>old_size_y&&this.add_faux_rows(size_y-old_size_y),size_x>old_size_x&&this.add_faux_cols(size_x-old_size_x),$widget.attr({"data-col":new_col,"data-sizex":size_x,"data-sizey":size_y}),empty_cols.length){var cols_to_remove_holes=[empty_cols[0],wgd.row,empty_cols.length,Math.min(old_size_y,size_y),$widget];this.remove_empty_cells.apply(this,cols_to_remove_holes)}if(empty_rows.length){var rows_to_remove_holes=[new_col,wgd.row,size_x,size_y,$widget];this.remove_empty_cells.apply(this,rows_to_remove_holes)}return $widget},fn.empty_cells=function(col,row,size_x,size_y,$exclude){var $nexts=this.widgets_below({col:col,row:row-size_y,size_x:size_x,size_y:size_y});return $nexts.not($exclude).each($.proxy(function(i,w){var wgd=$(w).coords().grid;if(wgd.row<=row+size_y-1){var diff=row+size_y-wgd.row;this.move_widget_down($(w),diff)}},this)),this.set_dom_grid_height(),this},fn.remove_empty_cells=function(col,row,size_x,size_y,exclude){var $nexts=this.widgets_below({col:col,row:row,size_x:size_x,size_y:size_y});return $nexts.not(exclude).each($.proxy(function(i,widget){this.move_widget_up($(widget),size_y)},this)),this.set_dom_grid_height(),this},fn.next_position=function(size_x,size_y){size_x||(size_x=1),size_y||(size_y=1);for(var rows_l,ga=this.gridmap,cols_l=ga.length,valid_pos=[],c=1;cols_l>c;c++){rows_l=ga[c].length;for(var r=1;rows_l>=r;r++){var can_move_to=this.can_move_to({size_x:size_x,size_y:size_y},c,r);can_move_to&&valid_pos.push({col:c,row:r,size_y:size_y,size_x:size_x})}}return valid_pos.length?this.sort_by_row_and_col_asc(valid_pos)[0]:!1},fn.remove_widget=function(el,silent,callback){var $el=el instanceof jQuery?el:$(el),wgd=$el.coords().grid;$.isFunction(silent)&&(callback=silent,silent=!1),this.cells_occupied_by_placeholder={},this.$widgets=this.$widgets.not($el);var $nexts=this.widgets_below($el);this.remove_from_gridmap(wgd),$el.fadeOut($.proxy(function(){$el.remove(),silent||$nexts.each($.proxy(function(i,widget){this.move_widget_up($(widget),wgd.size_y)},this)),this.set_dom_grid_height(),callback&&callback.call(this,el)},this))},fn.remove_all_widgets=function(callback){return this.$widgets.each($.proxy(function(i,el){this.remove_widget(el,!0,callback)},this)),this},fn.serialize=function($widgets){$widgets||($widgets=this.$widgets);var result=[];return $widgets.each($.proxy(function(i,widget){result.push(this.options.serialize_params($(widget),$(widget).coords().grid))},this)),result},fn.serialize_changed=function(){return this.serialize(this.$changed)},fn.register_widget=function($el){var wgd={col:parseInt($el.attr("data-col"),10),row:parseInt($el.attr("data-row"),10),size_x:parseInt($el.attr("data-sizex"),10),size_y:parseInt($el.attr("data-sizey"),10),el:$el};return this.options.avoid_overlapped_widgets&&!this.can_move_to({size_x:wgd.size_x,size_y:wgd.size_y},wgd.col,wgd.row)&&(wgd=this.next_position(wgd.size_x,wgd.size_y),wgd.el=$el,$el.attr({"data-col":wgd.col,"data-row":wgd.row,"data-sizex":wgd.size_x,"data-sizey":wgd.size_y})),$el.data("coords",$el.coords()),$el.data("coords").grid=wgd,this.add_to_gridmap(wgd,$el),this},fn.update_widget_position=function(grid_data,value){return this.for_each_cell_occupied(grid_data,function(col,row){return this.gridmap[col]?void(this.gridmap[col][row]=value):this}),this},fn.remove_from_gridmap=function(grid_data){return this.update_widget_position(grid_data,!1)},fn.add_to_gridmap=function(grid_data,value){if(this.update_widget_position(grid_data,value||grid_data.el),grid_data.el){var $widgets=this.widgets_below(grid_data.el);$widgets.each($.proxy(function(i,widget){this.move_widget_up($(widget))},this))}},fn.draggable=function(){var self=this,draggable_options=$.extend(!0,{},this.options.draggable,{offset_left:this.options.widget_margins[0],start:function(event,ui){self.$widgets.filter(".player-revert").removeClass("player-revert"),self.$player=$(this),self.$helper="clone"===self.options.draggable.helper?$(ui.helper):self.$player,self.helper=!self.$helper.is(self.$player),self.on_start_drag.call(self,event,ui),self.$el.trigger("gridster:dragstart")},stop:function(event,ui){self.on_stop_drag.call(self,event,ui),self.$el.trigger("gridster:dragstop")},drag:throttle(function(event,ui){self.on_drag.call(self,event,ui),self.$el.trigger("gridster:drag")},60)});return this.drag_api=this.$el.drag(draggable_options).data("drag"),this},fn.on_start_drag=function(event,ui){this.$helper.add(this.$player).add(this.$wrapper).addClass("dragging"),this.$player.addClass("player"),this.player_grid_data=this.$player.coords().grid,this.placeholder_grid_data=$.extend({},this.player_grid_data),this.$el.css("height",this.$el.height()+this.player_grid_data.size_y*this.min_widget_height);var colliders=this.faux_grid,coords=this.$player.data("coords").coords;this.cells_occupied_by_player=this.get_cells_occupied(this.player_grid_data),this.cells_occupied_by_placeholder=this.get_cells_occupied(this.placeholder_grid_data),this.last_cols=[],this.last_rows=[],this.collision_api=this.$helper.collision(colliders,this.options.collision),this.$preview_holder=$("<li />",{"class":"preview-holder","data-row":this.$player.attr("data-row"),"data-col":this.$player.attr("data-col"),css:{width:coords.width,height:coords.height}}).appendTo(this.$el),this.options.draggable.start&&this.options.draggable.start.call(this,event,ui)},fn.on_drag=function(event,ui){if(null===this.$player)return!1;var abs_offset={left:ui.position.left+this.baseX,top:ui.position.top+this.baseY};this.colliders_data=this.collision_api.get_closest_colliders(abs_offset),this.on_overlapped_column_change(this.on_start_overlapping_column,this.on_stop_overlapping_column),this.on_overlapped_row_change(this.on_start_overlapping_row,this.on_stop_overlapping_row),this.helper&&this.$player&&this.$player.css({left:ui.position.left,top:ui.position.top}),this.options.draggable.drag&&this.options.draggable.drag.call(this,event,ui)},fn.on_stop_drag=function(event,ui){this.$helper.add(this.$player).add(this.$wrapper).removeClass("dragging"),ui.position.left=ui.position.left+this.baseX,ui.position.top=ui.position.top+this.baseY,this.colliders_data=this.collision_api.get_closest_colliders(ui.position),this.on_overlapped_column_change(this.on_start_overlapping_column,this.on_stop_overlapping_column),this.on_overlapped_row_change(this.on_start_overlapping_row,this.on_stop_overlapping_row),this.$player.addClass("player-revert").removeClass("player").attr({"data-col":this.placeholder_grid_data.col,"data-row":this.placeholder_grid_data.row}).css({left:"",top:""}),this.$changed=this.$changed.add(this.$player),this.cells_occupied_by_player=this.get_cells_occupied(this.placeholder_grid_data),this.set_cells_player_occupies(this.placeholder_grid_data.col,this.placeholder_grid_data.row),this.$player.coords().grid.row=this.placeholder_grid_data.row,this.$player.coords().grid.col=this.placeholder_grid_data.col,this.options.draggable.stop&&this.options.draggable.stop.call(this,event,ui),this.$preview_holder.remove(),this.$player=null,this.$helper=null,this.placeholder_grid_data={},this.player_grid_data={},this.cells_occupied_by_placeholder={},this.cells_occupied_by_player={},this.set_dom_grid_height()},fn.on_overlapped_column_change=function(start_callback,stop_callback){if(!this.colliders_data.length)return this;var i,cols=this.get_targeted_columns(this.colliders_data[0].el.data.col),last_n_cols=this.last_cols.length,n_cols=cols.length;for(i=0;n_cols>i;i++)-1===$.inArray(cols[i],this.last_cols)&&(start_callback||$.noop).call(this,cols[i]);for(i=0;last_n_cols>i;i++)-1===$.inArray(this.last_cols[i],cols)&&(stop_callback||$.noop).call(this,this.last_cols[i]);return this.last_cols=cols,this},fn.on_overlapped_row_change=function(start_callback,end_callback){if(!this.colliders_data.length)return this;var i,rows=this.get_targeted_rows(this.colliders_data[0].el.data.row),last_n_rows=this.last_rows.length,n_rows=rows.length;for(i=0;n_rows>i;i++)-1===$.inArray(rows[i],this.last_rows)&&(start_callback||$.noop).call(this,rows[i]);for(i=0;last_n_rows>i;i++)-1===$.inArray(this.last_rows[i],rows)&&(end_callback||$.noop).call(this,this.last_rows[i]);this.last_rows=rows},fn.set_player=function(col,row,no_player){var self=this;no_player||this.empty_cells_player_occupies();var cell=no_player?{col:col}:self.colliders_data[0].el.data,to_col=cell.col,to_row=row||cell.row;this.player_grid_data={col:to_col,row:to_row,size_y:this.player_grid_data.size_y,size_x:this.player_grid_data.size_x},this.cells_occupied_by_player=this.get_cells_occupied(this.player_grid_data);var $overlapped_widgets=this.get_widgets_overlapped(this.player_grid_data),constraints=this.widgets_constraints($overlapped_widgets);if(this.manage_movements(constraints.can_go_up,to_col,to_row),this.manage_movements(constraints.can_not_go_up,to_col,to_row),!$overlapped_widgets.length){var pp=this.can_go_player_up(this.player_grid_data);pp!==!1&&(to_row=pp),this.set_placeholder(to_col,to_row)}return{col:to_col,row:to_row}},fn.widgets_constraints=function($widgets){var $widgets_can_not_go_up,$widgets_can_go_up=$([]),wgd_can_go_up=[],wgd_can_not_go_up=[];return $widgets.each($.proxy(function(i,w){var $w=$(w),wgd=$w.coords().grid;this.can_go_widget_up(wgd)?($widgets_can_go_up=$widgets_can_go_up.add($w),wgd_can_go_up.push(wgd)):wgd_can_not_go_up.push(wgd)},this)),$widgets_can_not_go_up=$widgets.not($widgets_can_go_up),{can_go_up:this.sort_by_row_asc(wgd_can_go_up),can_not_go_up:this.sort_by_row_desc(wgd_can_not_go_up)}},fn.sort_by_row_asc=function(widgets){return widgets=widgets.sort(function(a,b){return a.row||(a=$(a).coords().grid,b=$(b).coords().grid),a.row>b.row?1:-1})},fn.sort_by_row_and_col_asc=function(widgets){return widgets=widgets.sort(function(a,b){return a.row>b.row||a.row===b.row&&a.col>b.col?1:-1})},fn.sort_by_col_asc=function(widgets){return widgets=widgets.sort(function(a,b){return a.col>b.col?1:-1})},fn.sort_by_row_desc=function(widgets){return widgets=widgets.sort(function(a,b){return a.row+a.size_y<b.row+b.size_y?1:-1})},fn.manage_movements=function($widgets,to_col,to_row){return $.each($widgets,$.proxy(function(i,w){var wgd=w,$w=wgd.el,can_go_widget_up=this.can_go_widget_up(wgd);if(can_go_widget_up)this.move_widget_to($w,can_go_widget_up),this.set_placeholder(to_col,can_go_widget_up+wgd.size_y);else{var can_go_player_up=this.can_go_player_up(this.player_grid_data);if(!can_go_player_up){var y=to_row+this.player_grid_data.size_y-wgd.row;this.move_widget_down($w,y),this.set_placeholder(to_col,to_row)}}},this)),this},fn.is_player=function(col_or_el,row){if(row&&!this.gridmap[col_or_el])return!1;var $w=row?this.gridmap[col_or_el][row]:col_or_el;return $w&&($w.is(this.$player)||$w.is(this.$helper))},fn.is_player_in=function(col,row){var c=this.cells_occupied_by_player||{};return $.inArray(col,c.cols)>=0&&$.inArray(row,c.rows)>=0},fn.is_placeholder_in=function(col,row){var c=this.cells_occupied_by_placeholder||{};return this.is_placeholder_in_col(col)&&$.inArray(row,c.rows)>=0},fn.is_placeholder_in_col=function(col){var c=this.cells_occupied_by_placeholder||[];return $.inArray(col,c.cols)>=0},fn.is_empty=function(col,row){return"undefined"!=typeof this.gridmap[col]&&"undefined"!=typeof this.gridmap[col][row]&&this.gridmap[col][row]===!1?!0:!1},fn.is_occupied=function(col,row){return this.gridmap[col]&&this.gridmap[col][row]?!0:!1},fn.is_widget=function(col,row){var cell=this.gridmap[col];return cell?(cell=cell[row],cell?cell:!1):!1},fn.is_widget_under_player=function(col,row){return this.is_widget(col,row)?this.is_player_in(col,row):!1},fn.get_widgets_under_player=function(cells){cells||(cells=this.cells_occupied_by_player||{cols:[],rows:[]});var $widgets=$([]);return $.each(cells.cols,$.proxy(function(i,col){$.each(cells.rows,$.proxy(function(i,row){this.is_widget(col,row)&&($widgets=$widgets.add(this.gridmap[col][row]))},this))},this)),$widgets},fn.set_placeholder=function(col,row){var phgd=$.extend({},this.placeholder_grid_data),$nexts=this.widgets_below({col:phgd.col,row:phgd.row,size_y:phgd.size_y,size_x:phgd.size_x}),right_col=col+phgd.size_x-1;right_col>this.cols&&(col-=right_col-col);var moved_down=this.placeholder_grid_data.row<row,changed_column=this.placeholder_grid_data.col!==col;this.placeholder_grid_data.col=col,this.placeholder_grid_data.row=row,this.cells_occupied_by_placeholder=this.get_cells_occupied(this.placeholder_grid_data),this.$preview_holder.attr({"data-row":row,"data-col":col}),(moved_down||changed_column)&&$nexts.each($.proxy(function(i,widget){this.move_widget_up($(widget),this.placeholder_grid_data.col-col+phgd.size_y)},this));var $widgets_under_ph=this.get_widgets_under_player(this.cells_occupied_by_placeholder);$widgets_under_ph.length&&$widgets_under_ph.each($.proxy(function(i,widget){var $w=$(widget);this.move_widget_down($w,row+phgd.size_y-$w.data("coords").grid.row)},this))},fn.can_go_player_up=function(widget_grid_data){var p_bottom_row=widget_grid_data.row+widget_grid_data.size_y-1,result=!0,upper_rows=[],min_row=1e4,$widgets_under_player=this.get_widgets_under_player();return this.for_each_column_occupied(widget_grid_data,function(tcol){var grid_col=this.gridmap[tcol],r=p_bottom_row+1;for(upper_rows[tcol]=[];--r>0&&(this.is_empty(tcol,r)||this.is_player(tcol,r)||this.is_widget(tcol,r)&&grid_col[r].is($widgets_under_player));)upper_rows[tcol].push(r),min_row=min_row>r?r:min_row;return 0===upper_rows[tcol].length?(result=!1,!0):void upper_rows[tcol].sort()}),result?this.get_valid_rows(widget_grid_data,upper_rows,min_row):!1},fn.can_go_widget_up=function(widget_grid_data){var p_bottom_row=widget_grid_data.row+widget_grid_data.size_y-1,result=!0,upper_rows=[],min_row=1e4;return this.for_each_column_occupied(widget_grid_data,function(tcol){var grid_col=this.gridmap[tcol];upper_rows[tcol]=[];for(var r=p_bottom_row+1;--r>0&&(!this.is_widget(tcol,r)||this.is_player_in(tcol,r)||grid_col[r].is(widget_grid_data.el));)this.is_player(tcol,r)||this.is_placeholder_in(tcol,r)||this.is_player_in(tcol,r)||upper_rows[tcol].push(r),min_row>r&&(min_row=r);return 0===upper_rows[tcol].length?(result=!1,!0):void upper_rows[tcol].sort()}),result?this.get_valid_rows(widget_grid_data,upper_rows,min_row):!1},fn.get_valid_rows=function(widget_grid_data,upper_rows,min_row){for(var p_top_row=widget_grid_data.row,p_bottom_row=widget_grid_data.row+widget_grid_data.size_y-1,size_y=widget_grid_data.size_y,r=min_row-1,valid_rows=[];++r<=p_bottom_row;){var common=!0;if($.each(upper_rows,function(col,rows){$.isArray(rows)&&-1===$.inArray(r,rows)&&(common=!1)}),common===!0&&(valid_rows.push(r),valid_rows.length===size_y))break}var new_row=!1;return 1===size_y?valid_rows[0]!==p_top_row&&(new_row=valid_rows[0]||!1):valid_rows[0]!==p_top_row&&(new_row=this.get_consecutive_numbers_index(valid_rows,size_y)),new_row},fn.get_consecutive_numbers_index=function(arr,size_y){for(var max=arr.length,result=[],first=!0,prev=-1,i=0;max>i;i++){if(first||arr[i]===prev+1){if(result.push(i),result.length===size_y)break;first=!1}else result=[],first=!0;prev=arr[i]}return result.length>=size_y?arr[result[0]]:!1},fn.get_widgets_overlapped=function(){var $widgets=$([]),used=[],rows_from_bottom=this.cells_occupied_by_player.rows.slice(0);return rows_from_bottom.reverse(),$.each(this.cells_occupied_by_player.cols,$.proxy(function(i,col){$.each(rows_from_bottom,$.proxy(function(i,row){if(!this.gridmap[col])return!0;var $w=this.gridmap[col][row];this.is_occupied(col,row)&&!this.is_player($w)&&-1===$.inArray($w,used)&&($widgets=$widgets.add($w),used.push($w))},this))},this)),$widgets},fn.on_start_overlapping_column=function(col){this.set_player(col,!1)},fn.on_start_overlapping_row=function(row){this.set_player(!1,row)},fn.on_stop_overlapping_column=function(col){this.set_player(col,!1);var self=this;this.for_each_widget_below(col,this.cells_occupied_by_player.rows[0],function(){self.move_widget_up(this,self.player_grid_data.size_y)})},fn.on_stop_overlapping_row=function(row){this.set_player(!1,row);for(var self=this,cols=this.cells_occupied_by_player.cols,c=0,cl=cols.length;cl>c;c++)this.for_each_widget_below(cols[c],row,function(){self.move_widget_up(this,self.player_grid_data.size_y)})},fn.move_widget_to=function($widget,row){var self=this,widget_grid_data=$widget.coords().grid,$next_widgets=(row-widget_grid_data.row,this.widgets_below($widget)),can_move_to_new_cell=this.can_move_to(widget_grid_data,widget_grid_data.col,row,$widget);
return can_move_to_new_cell===!1?!1:(this.remove_from_gridmap(widget_grid_data),widget_grid_data.row=row,this.add_to_gridmap(widget_grid_data),$widget.attr("data-row",row),this.$changed=this.$changed.add($widget),$next_widgets.each(function(i,widget){var $w=$(widget),wgd=$w.coords().grid,can_go_up=self.can_go_widget_up(wgd);can_go_up&&can_go_up!==wgd.row&&self.move_widget_to($w,can_go_up)}),this)},fn.move_widget_up=function($widget,y_units){var el_grid_data=$widget.coords().grid,actual_row=el_grid_data.row,moved=[];return y_units||(y_units=1),this.can_go_up($widget)?void this.for_each_column_occupied(el_grid_data,function(col){if(-1===$.inArray($widget,moved)){var widget_grid_data=$widget.coords().grid,next_row=actual_row-y_units;if(next_row=this.can_go_up_to_row(widget_grid_data,col,next_row),!next_row)return!0;var $next_widgets=this.widgets_below($widget);this.remove_from_gridmap(widget_grid_data),widget_grid_data.row=next_row,this.add_to_gridmap(widget_grid_data),$widget.attr("data-row",widget_grid_data.row),this.$changed=this.$changed.add($widget),moved.push($widget),$next_widgets.each($.proxy(function(i,widget){this.move_widget_up($(widget),y_units)},this))}}):!1},fn.move_widget_down=function($widget,y_units){var el_grid_data=$widget.coords().grid,actual_row=el_grid_data.row,moved=[],y_diff=y_units;if(!$widget)return!1;if(-1===$.inArray($widget,moved)){var widget_grid_data=$widget.coords().grid,next_row=actual_row+y_units,$next_widgets=this.widgets_below($widget);this.remove_from_gridmap(widget_grid_data),$next_widgets.each($.proxy(function(i,widget){var $w=$(widget),wd=$w.coords().grid,tmp_y=this.displacement_diff(wd,widget_grid_data,y_diff);tmp_y>0&&this.move_widget_down($w,tmp_y)},this)),widget_grid_data.row=next_row,this.update_widget_position(widget_grid_data,$widget),$widget.attr("data-row",widget_grid_data.row),this.$changed=this.$changed.add($widget),moved.push($widget)}},fn.can_go_up_to_row=function(widget_grid_data,col,row){var r,ga=this.gridmap,result=!0,urc=[],actual_row=widget_grid_data.row;if(this.for_each_column_occupied(widget_grid_data,function(tcol){ga[tcol];for(urc[tcol]=[],r=actual_row;r--&&this.is_empty(tcol,r)&&!this.is_placeholder_in(tcol,r);)urc[tcol].push(r);return urc[tcol].length?void 0:(result=!1,!0)}),!result)return!1;for(r=row,r=1;actual_row>r;r++){for(var common=!0,uc=0,ucl=urc.length;ucl>uc;uc++)urc[uc]&&-1===$.inArray(r,urc[uc])&&(common=!1);if(common===!0){result=r;break}}return result},fn.displacement_diff=function(widget_grid_data,parent_bgd,y_units){var actual_row=widget_grid_data.row,diffs=[],parent_max_y=parent_bgd.row+parent_bgd.size_y;this.for_each_column_occupied(widget_grid_data,function(col){for(var temp_y_units=0,r=parent_max_y;actual_row>r;r++)this.is_empty(col,r)&&(temp_y_units+=1);diffs.push(temp_y_units)});var max_diff=Math.max.apply(Math,diffs);return y_units-=max_diff,y_units>0?y_units:0},fn.widgets_below=function($el){var el_grid_data=$.isPlainObject($el)?$el:$el.coords().grid,self=this,next_row=(this.gridmap,el_grid_data.row+el_grid_data.size_y-1),$nexts=$([]);return this.for_each_column_occupied(el_grid_data,function(col){self.for_each_widget_below(col,next_row,function(){return self.is_player(this)||-1!==$.inArray(this,$nexts)?void 0:($nexts=$nexts.add(this),!0)})}),this.sort_by_row_asc($nexts)},fn.set_cells_player_occupies=function(col,row){return this.remove_from_gridmap(this.placeholder_grid_data),this.placeholder_grid_data.col=col,this.placeholder_grid_data.row=row,this.add_to_gridmap(this.placeholder_grid_data,this.$player),this},fn.empty_cells_player_occupies=function(){return this.remove_from_gridmap(this.placeholder_grid_data),this},fn.can_go_up=function($el){var el_grid_data=$el.coords().grid,initial_row=el_grid_data.row,prev_row=initial_row-1,result=(this.gridmap,!0);return 1===initial_row?!1:(this.for_each_column_occupied(el_grid_data,function(col){this.is_widget(col,prev_row);return this.is_occupied(col,prev_row)||this.is_player(col,prev_row)||this.is_placeholder_in(col,prev_row)||this.is_player_in(col,prev_row)?(result=!1,!0):void 0}),result)},fn.can_move_to=function(widget_grid_data,col,row,max_row){var $w=(this.gridmap,widget_grid_data.el),future_wd={size_y:widget_grid_data.size_y,size_x:widget_grid_data.size_x,col:col,row:row},result=!0,right_col=col+widget_grid_data.size_x-1;return right_col>this.cols?!1:max_row&&max_row<row+widget_grid_data.size_y-1?!1:(this.for_each_cell_occupied(future_wd,function(tcol,trow){var $tw=this.is_widget(tcol,trow);!$tw||widget_grid_data.el&&!$tw.is($w)||(result=!1)}),result)},fn.get_targeted_columns=function(from_col){for(var max=(from_col||this.player_grid_data.col)+(this.player_grid_data.size_x-1),cols=[],col=from_col;max>=col;col++)cols.push(col);return cols},fn.get_targeted_rows=function(from_row){for(var max=(from_row||this.player_grid_data.row)+(this.player_grid_data.size_y-1),rows=[],row=from_row;max>=row;row++)rows.push(row);return rows},fn.get_cells_occupied=function(el_grid_data){var i,cells={cols:[],rows:[]};for(arguments[1]instanceof jQuery&&(el_grid_data=arguments[1].coords().grid),i=0;i<el_grid_data.size_x;i++){var col=el_grid_data.col+i;cells.cols.push(col)}for(i=0;i<el_grid_data.size_y;i++){var row=el_grid_data.row+i;cells.rows.push(row)}return cells},fn.for_each_cell_occupied=function(grid_data,callback){return this.for_each_column_occupied(grid_data,function(col){this.for_each_row_occupied(grid_data,function(row){callback.call(this,col,row)})}),this},fn.for_each_column_occupied=function(el_grid_data,callback){for(var i=0;i<el_grid_data.size_x;i++){var col=el_grid_data.col+i;callback.call(this,col,el_grid_data)}},fn.for_each_row_occupied=function(el_grid_data,callback){for(var i=0;i<el_grid_data.size_y;i++){var row=el_grid_data.row+i;callback.call(this,row,el_grid_data)}},fn._traversing_widgets=function(type,direction,col,row,callback){var ga=this.gridmap;if(ga[col]){var cr,max,action=type+"/"+direction;if(arguments[2]instanceof jQuery){var el_grid_data=arguments[2].coords().grid;col=el_grid_data.col,row=el_grid_data.row,callback=arguments[3]}var matched=[],trow=row,methods={"for_each/above":function(){for(;trow--&&!(trow>0&&this.is_widget(col,trow)&&-1===$.inArray(ga[col][trow],matched)&&(cr=callback.call(ga[col][trow],col,trow),matched.push(ga[col][trow]),cr)););},"for_each/below":function(){for(trow=row+1,max=ga[col].length;max>trow&&(!this.is_widget(col,trow)||-1!==$.inArray(ga[col][trow],matched)||(cr=callback.call(ga[col][trow],col,trow),matched.push(ga[col][trow]),!cr));trow++);}};methods[action]&&methods[action].call(this)}},fn.for_each_widget_above=function(col,row,callback){return this._traversing_widgets("for_each","above",col,row,callback),this},fn.for_each_widget_below=function(col,row,callback){return this._traversing_widgets("for_each","below",col,row,callback),this},fn.get_highest_occupied_cell=function(){for(var r,gm=this.gridmap,rows=[],row_in_col=[],c=gm.length-1;c>=1;c--)for(r=gm[c].length-1;r>=1;r--)if(this.is_widget(c,r)){rows.push(r),row_in_col[r]=c;break}var highest_row=Math.max.apply(Math,rows);return this.highest_occupied_cell={col:row_in_col[highest_row],row:highest_row},this.highest_occupied_cell},fn.get_widgets_from=function(col,row){var $widgets=(this.gridmap,$());return col&&($widgets=$widgets.add(this.$widgets.filter(function(){var tcol=$(this).attr("data-col");return tcol===col||tcol>col}))),row&&($widgets=$widgets.add(this.$widgets.filter(function(){var trow=$(this).attr("data-row");return trow===row||trow>row}))),$widgets},fn.set_dom_grid_height=function(){var r=this.get_highest_occupied_cell().row;return this.$el.css("height",r*this.min_widget_height),this},fn.generate_stylesheet=function(opts){var i,styles="",max_size_x=this.options.max_size_x;opts||(opts={}),opts.cols||(opts.cols=this.cols),opts.rows||(opts.rows=this.rows),opts.namespace||(opts.namespace=this.options.namespace),opts.widget_base_dimensions||(opts.widget_base_dimensions=this.options.widget_base_dimensions),opts.widget_margins||(opts.widget_margins=this.options.widget_margins),opts.min_widget_width=2*opts.widget_margins[0]+opts.widget_base_dimensions[0],opts.min_widget_height=2*opts.widget_margins[1]+opts.widget_base_dimensions[1];var serialized_opts=$.param(opts);if($.inArray(serialized_opts,Gridster.generated_stylesheets)>=0)return!1;for(Gridster.generated_stylesheets.push(serialized_opts),i=opts.cols;i>=0;i--)styles+=opts.namespace+' [data-col="'+(i+1)+'"] { left:'+(i*opts.widget_base_dimensions[0]+i*opts.widget_margins[0]+(i+1)*opts.widget_margins[0])+"px;} ";for(i=opts.rows;i>=0;i--)styles+=opts.namespace+' [data-row="'+(i+1)+'"] { top:'+(i*opts.widget_base_dimensions[1]+i*opts.widget_margins[1]+(i+1)*opts.widget_margins[1])+"px;} ";for(var y=1;y<=opts.rows;y++)styles+=opts.namespace+' [data-sizey="'+y+'"] { height:'+(y*opts.widget_base_dimensions[1]+2*(y-1)*opts.widget_margins[1])+"px;}";for(var x=1;max_size_x>=x;x++)styles+=opts.namespace+' [data-sizex="'+x+'"] { width:'+(x*opts.widget_base_dimensions[0]+2*(x-1)*opts.widget_margins[0])+"px;}";return this.add_style_tag(styles)},fn.add_style_tag=function(css){var d=document,tag=d.createElement("style");return d.getElementsByTagName("head")[0].appendChild(tag),tag.setAttribute("type","text/css"),tag.styleSheet?tag.styleSheet.cssText=css:tag.appendChild(document.createTextNode(css)),this},fn.generate_faux_grid=function(rows,cols){this.faux_grid=[],this.gridmap=[];var col,row;for(col=cols;col>0;col--)for(this.gridmap[col]=[],row=rows;row>0;row--)this.add_faux_cell(row,col);return this},fn.add_faux_cell=function(row,col){var coords=$({left:this.baseX+(col-1)*this.min_widget_width,top:this.baseY+(row-1)*this.min_widget_height,width:this.min_widget_width,height:this.min_widget_height,col:col,row:row,original_col:col,original_row:row}).coords();return $.isArray(this.gridmap[col])||(this.gridmap[col]=[]),this.gridmap[col][row]=!1,this.faux_grid.push(coords),this},fn.add_faux_rows=function(rows){for(var actual_rows=this.rows,max_rows=actual_rows+(rows||1),r=max_rows;r>actual_rows;r--)for(var c=this.cols;c>=1;c--)this.add_faux_cell(r,c);return this.rows=max_rows,this.options.autogenerate_stylesheet&&this.generate_stylesheet(),this},fn.add_faux_cols=function(cols){for(var actual_cols=this.cols,max_cols=actual_cols+(cols||1),c=actual_cols;max_cols>c;c++)for(var r=this.rows;r>=1;r--)this.add_faux_cell(r,c);return this.cols=max_cols,this.options.autogenerate_stylesheet&&this.generate_stylesheet(),this},fn.recalculate_faux_grid=function(){var aw=this.$wrapper.width();return this.baseX=($(window).width()-aw)/2,this.baseY=this.$wrapper.offset().top,$.each(this.faux_grid,$.proxy(function(i,coords){this.faux_grid[i]=coords.update({left:this.baseX+(coords.data.col-1)*this.min_widget_width,top:this.baseY+(coords.data.row-1)*this.min_widget_height})},this)),this},fn.get_widgets_from_DOM=function(){return this.$widgets.each($.proxy(function(i,widget){this.register_widget($(widget))},this)),this},fn.generate_grid_and_stylesheet=function(){var aw=this.$wrapper.width(),cols=(this.$wrapper.height(),Math.floor(aw/this.min_widget_width)+this.options.extra_cols),actual_cols=this.$widgets.map(function(){return $(this).attr("data-col")});actual_cols=Array.prototype.slice.call(actual_cols,0),actual_cols.length||(actual_cols=[0]);var min_cols=Math.max.apply(Math,actual_cols),max_rows=this.options.extra_rows;return this.$widgets.each(function(i,w){max_rows+=+$(w).attr("data-sizey")}),this.cols=Math.max(min_cols,cols,this.options.min_cols),this.rows=Math.max(max_rows,this.options.min_rows),this.baseX=($(window).width()-aw)/2,this.baseY=this.$wrapper.offset().top,this.options.autogenerate_stylesheet&&this.generate_stylesheet(),this.generate_faux_grid(this.rows,this.cols)},fn.destroy=function(){$(window).unbind("resize",this.on_window_resize),this.drag_api&&this.drag_api.destroy(),this.$el.remove()},$.fn.gridster=function(options){return this.each(function(){$(this).data("gridster")||$(this).data("gridster",new Gridster(this,options))})},$.Gridster=fn}(jQuery,window,document),function($){$.fn.extend({leanModal:function(options){function close_modal(modal_id){$("#lean_overlay").fadeOut(200),$(modal_id).css({display:"none"})}var defaults={top:100,overlay:.5,closeButton:null},overlay=$("<div id='lean_overlay'></div>");return $("body").append(overlay),options=$.extend(defaults,options),this.each(function(){var o=options;$(this).click(function(e){var modal_id=$(this).attr("href");$("#lean_overlay").click(function(){close_modal(modal_id)}),$(o.closeButton).click(function(){close_modal(modal_id)});var modal_width=($(modal_id).outerHeight(),$(modal_id).outerWidth());$("#lean_overlay").css({display:"block",opacity:0}),$("#lean_overlay").fadeTo(200,o.overlay),$(modal_id).css({display:"block",position:"fixed",opacity:0,"z-index":11e3,left:"50%","margin-left":-(modal_width/2)+"px",top:o.top+"px"}),$(modal_id).fadeTo(200,1),e.preventDefault()})})}})}(jQuery),function(){Dashing.gridsterLayout=function(positions){var index,widget,widgets,_i,_len,_results;for(Dashing.customGridsterLayout=!0,positions=positions.replace(/^"|"$/g,""),positions=$.parseJSON(positions),widgets=$("[data-row^=]"),_results=[],index=_i=0,_len=widgets.length;_len>_i;index=++_i)widget=widgets[index],$(widget).attr("data-row",positions[index].row),_results.push($(widget).attr("data-col",positions[index].col));return _results},Dashing.getWidgetPositions=function(){return $(".gridster > ul").gridster().data("gridster").serialize()},Dashing.showGridsterInstructions=function(){var newWidgetPositions;return newWidgetPositions=Dashing.getWidgetPositions(),JSON.stringify(newWidgetPositions)!==JSON.stringify(Dashing.currentWidgetPositions)?(Dashing.currentWidgetPositions=newWidgetPositions,$("#save-gridster").slideDown(),$("#gridster-code").text("<script type='text/javascript'>\n $(function() {\n   Dashing.gridsterLayout('"+JSON.stringify(Dashing.currentWidgetPositions)+"')\n });\n </script>")):void 0},$(function(){return $("#save-gridster").leanModal(),$("#save-gridster").click(function(){return $("#save-gridster").slideUp()})})}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.Clock=function(_super){function Clock(){return this.startTime=__bind(this.startTime,this),Clock.__super__.constructor.apply(this,arguments)}return __extends(Clock,_super),Clock.prototype.ready=function(){return setInterval(this.startTime,500)},Clock.prototype.startTime=function(){var h,m,s,today;return today=new Date,h=today.getHours(),m=today.getMinutes(),s=today.getSeconds(),m=this.formatTime(m),s=this.formatTime(s),this.set("time",h+":"+m+":"+s),this.set("date",today.toDateString())},Clock.prototype.formatTime=function(i){return 10>i?"0"+i:i},Clock}(Dashing.Widget)}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.Comments=function(_super){function Comments(){return this.nextComment=__bind(this.nextComment,this),Comments.__super__.constructor.apply(this,arguments)}return __extends(Comments,_super),Comments.accessor("quote",function(){var _ref;return"\u201c"+(null!=(_ref=this.get("current_comment"))?_ref.body:void 0)+"\u201d"}),Comments.prototype.ready=function(){return this.currentIndex=0,this.commentElem=$(this.node).find(".comment-container"),this.nextComment(),this.startCarousel()},Comments.prototype.onData=function(){return this.currentIndex=0},Comments.prototype.startCarousel=function(){return setInterval(this.nextComment,8e3)},Comments.prototype.nextComment=function(){var comments;return comments=this.get("comments"),comments?this.commentElem.fadeOut(function(_this){return function(){return _this.currentIndex=(_this.currentIndex+1)%comments.length,_this.set("current_comment",comments[_this.currentIndex]),_this.commentElem.fadeIn()}}(this)):void 0},Comments}(Dashing.Widget)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.Graph=function(_super){function Graph(){return Graph.__super__.constructor.apply(this,arguments)}return __extends(Graph,_super),Graph.accessor("current",function(){var points;return this.get("displayedValue")?this.get("displayedValue"):(points=this.get("points"),points?points[points.length-1].y:void 0)}),Graph.prototype.ready=function(){var container,height,width,x_axis,y_axis;return container=$(this.node).parent(),width=Dashing.widget_base_dimensions[0]*container.data("sizex")+2*Dashing.widget_margins[0]*(container.data("sizex")-1),height=Dashing.widget_base_dimensions[1]*container.data("sizey"),this.graph=new Rickshaw.Graph({element:this.node,width:width,height:height,renderer:this.get("graphtype"),series:[{color:"#fff",data:[{x:0,y:0}]}]}),this.get("points")&&(this.graph.series[0].data=this.get("points")),x_axis=new Rickshaw.Graph.Axis.Time({graph:this.graph}),y_axis=new Rickshaw.Graph.Axis.Y({graph:this.graph,tickFormat:Rickshaw.Fixtures.Number.formatKMBT}),this.graph.render()},Graph.prototype.onData=function(data){return this.graph?(this.graph.series[0].data=data.points,this.graph.render()):void 0},Graph}(Dashing.Widget)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.Iframe=function(_super){function Iframe(){return Iframe.__super__.constructor.apply(this,arguments)}return __extends(Iframe,_super),Iframe.prototype.ready=function(){},Iframe.prototype.onData=function(){},Iframe}(Dashing.Widget)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.Image=function(_super){function Image(){return Image.__super__.constructor.apply(this,arguments)}return __extends(Image,_super),Image.prototype.ready=function(){},Image.prototype.onData=function(){},Image}(Dashing.Widget)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.List=function(_super){function List(){return List.__super__.constructor.apply(this,arguments)}return __extends(List,_super),List.prototype.ready=function(){return this.get("unordered")?$(this.node).find("ol").remove():$(this.node).find("ul").remove()},List}(Dashing.Widget)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.Meter=function(_super){function Meter(){Meter.__super__.constructor.apply(this,arguments),this.observe("value",function(value){return $(this.node).find(".meter").val(value).trigger("change")})}return __extends(Meter,_super),Meter.accessor("value",Dashing.AnimatedValue),Meter.prototype.ready=function(){var meter;return meter=$(this.node).find(".meter"),meter.attr("data-bgcolor",meter.css("background-color")),meter.attr("data-fgcolor",meter.css("color")),meter.knob()},Meter}(Dashing.Widget)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.Number=function(_super){function Number(){return Number.__super__.constructor.apply(this,arguments)}return __extends(Number,_super),Number.accessor("current",Dashing.AnimatedValue),Number.accessor("difference",function(){var current,diff,last;return this.get("last")?(last=parseInt(this.get("last")),current=parseInt(this.get("current")),0!==last?(diff=Math.abs(Math.round((current-last)/last*100)),""+diff+"%"):void 0):""}),Number.accessor("arrow",function(){return this.get("last")?parseInt(this.get("current"))>parseInt(this.get("last"))?"fa fa-arrow-up":"fa fa-arrow-down":void 0}),Number.prototype.onData=function(data){return data.status?($(this.get("node")).attr("class",function(i,c){return c.replace(/\bstatus-\S+/g,"")}),$(this.get("node")).addClass("status-"+data.status)):void 0},Number}(Dashing.Widget)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.Text=function(_super){function Text(){return Text.__super__.constructor.apply(this,arguments)}return __extends(Text,_super),Text}(Dashing.Widget)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.Arrival=function(_super){function Arrival(){return Arrival.__super__.constructor.apply(this,arguments)}return __extends(Arrival,_super),Arrival.prototype.ready=function(){},Arrival.prototype.onData=function(){},Arrival}(Dashing.Widget)}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.Clock=function(_super){function Clock(){return this.startTime=__bind(this.startTime,this),Clock.__super__.constructor.apply(this,arguments)}return __extends(Clock,_super),Clock.prototype.ready=function(){return setInterval(this.startTime,500)},Clock.prototype.startTime=function(){var h,m,s,today;return today=new Date,h=today.getHours(),m=today.getMinutes(),s=today.getSeconds(),m=this.formatTime(m),s=this.formatTime(s),this.set("time",h+":"+m+":"+s),this.set("date",today.toDateString())},Clock.prototype.formatTime=function(i){return 10>i?"0"+i:i},Clock}(Dashing.Widget)}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.Comments=function(_super){function Comments(){return this.nextComment=__bind(this.nextComment,this),Comments.__super__.constructor.apply(this,arguments)}return __extends(Comments,_super),Comments.accessor("quote",function(){var _ref;return"\u201c"+(null!=(_ref=this.get("current_comment"))?_ref.body:void 0)+"\u201d"}),Comments.prototype.ready=function(){return this.currentIndex=0,this.commentElem=$(this.node).find(".comment-container"),this.nextComment(),this.startCarousel()},Comments.prototype.onData=function(){return this.currentIndex=0},Comments.prototype.startCarousel=function(){return setInterval(this.nextComment,8e3)},Comments.prototype.nextComment=function(){var comments;return comments=this.get("comments"),comments?this.commentElem.fadeOut(function(_this){return function(){return _this.currentIndex=(_this.currentIndex+1)%comments.length,_this.set("current_comment",comments[_this.currentIndex]),_this.commentElem.fadeIn()}}(this)):void 0},Comments}(Dashing.Widget)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.Departure=function(_super){function Departure(){return Departure.__super__.constructor.apply(this,arguments)}return __extends(Departure,_super),Departure}(Dashing.Widget)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.Departure2=function(_super){function Departure2(){return Departure2.__super__.constructor.apply(this,arguments)}return __extends(Departure2,_super),Departure2.accessor("j_booked_percentage",Dashing.AnimatedValue),Departure2.accessor("w_booked_percentage",Dashing.AnimatedValue),Departure2.accessor("y_booked_percentage",Dashing.AnimatedValue),Departure2.accessor("total_booked_percentage",Dashing.AnimatedValue),Departure2.prototype.ready=function(){return $(this.node).find(".meter").each(function(){return function(index,element){var meter;return console.log(element),console.log(index),meter=$(element),meter.val(meter.attr("value")).trigger("change"),console.log(meter.attr("value")),meter.attr("data-bgcolor","orange"),meter.attr("data-fgcolor","blue"),meter.attr("data-width","100"),meter.attr("data-height","95"),meter.attr("data-thickness",".3"),meter.attr("data-angleArc","250"),meter.attr("data-angleOffset","-125"),meter.attr("data-displayInput","false"),meter.attr("data-readOnly","true"),meter.knob(),meter.val(meter.attr("value")).trigger("change")}}(this))},Departure2}(Dashing.Widget)}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.Flickr=function(_super){function Flickr(){return this.nextPhoto=__bind(this.nextPhoto,this),Flickr.__super__.constructor.apply(this,arguments)}return __extends(Flickr,_super),Flickr.prototype.ready=function(){return this.currentIndex=0,this.photoElem=$(this.node).find(".photo-container"),this.nextPhoto(),this.startCarousel()},Flickr.prototype.onData=function(){return this.currentIndex=0},Flickr.prototype.startCarousel=function(){return setInterval(this.nextPhoto,1e4)},Flickr.prototype.nextPhoto=function(){var photos;return photos=this.get("photos"),photos?this.photoElem.fadeOut(function(_this){return function(){return _this.currentIndex+=1,_this.currentIndex>=photos.length&&(_this.currentIndex-=photos.length),_this.set("current_photo",photos[_this.currentIndex]),_this.photoElem.fadeIn()}}(this)):void 0},Flickr}(Dashing.Widget)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.Flifo=function(_super){function Flifo(){return Flifo.__super__.constructor.apply(this,arguments)}return __extends(Flifo,_super),Flifo.prototype.ready=function(){},Flifo.prototype.onData=function(){},Flifo}(Dashing.Widget)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1};Dashing.Forecast=function(_super){function Forecast(){Forecast.__super__.constructor.apply(this,arguments),this.skycons=new Skycons({color:"white"}),this.skycons.play()}return __extends(Forecast,_super),Forecast.prototype.ready=function(){},Forecast.prototype.onData=function(data){return this.setSkycon(data.code)},Forecast.prototype.setSkycon=function(currentCondition){var codes,skycon,weatherCodes,_results;weatherCodes={"Skycons.CLEAR_DAY":["113"],"Skycons.PARTLY_CLOUDY_DAY":["116"],"Skycons.CLOUDY":["119","122","200"],"Skycons.FOG":["143","248","260"],"Skycons.RAIN":["176","185","182","263","266","281","284","293","296","299","302","305","308","311","314","317","320","350","353","356","359","362","365","374","377","386","389"],"Skycons.SNOW":["179","227","230","323","326","329","332","335","338","368","371","392","395"]},_results=[];for(skycon in weatherCodes)codes=weatherCodes[skycon],__indexOf.call(codes,currentCondition)>=0&&_results.push(this.skycons.set("weather-icon",eval(skycon)));return _results},Forecast}(Dashing.Widget)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Batman.mixin(Batman.Filters,{startText:function(str_start){var now,start;return now=moment.utc(),start=moment.unix(str_start),""+start.from(now)}}),Dashing.GoogleCalendar=function(_super){function GoogleCalendar(){return GoogleCalendar.__super__.constructor.apply(this,arguments)}return __extends(GoogleCalendar,_super),GoogleCalendar}(Dashing.Widget)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.Graph=function(_super){function Graph(){return Graph.__super__.constructor.apply(this,arguments)}return __extends(Graph,_super),Graph.accessor("current",function(){var points;return this.get("displayedValue")?this.get("displayedValue"):(points=this.get("points"),points?points[points.length-1].y:void 0)}),Graph.prototype.ready=function(){var container,height,width,x_axis,y_axis;return container=$(this.node).parent(),width=Dashing.widget_base_dimensions[0]*container.data("sizex")+2*Dashing.widget_margins[0]*(container.data("sizex")-1),height=Dashing.widget_base_dimensions[1]*container.data("sizey"),this.graph=new Rickshaw.Graph({element:this.node,width:width,height:height,renderer:this.get("graphtype"),series:[{color:"#fff",data:[{x:0,y:0}]}]}),this.get("points")&&(this.graph.series[0].data=this.get("points")),x_axis=new Rickshaw.Graph.Axis.Time({graph:this.graph}),y_axis=new Rickshaw.Graph.Axis.Y({graph:this.graph,tickFormat:Rickshaw.Fixtures.Number.formatKMBT}),this.graph.render()},Graph.prototype.onData=function(data){return this.graph?(this.graph.series[0].data=data.points,this.graph.render()):void 0},Graph}(Dashing.Widget)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.Iframe=function(_super){function Iframe(){return Iframe.__super__.constructor.apply(this,arguments)}return __extends(Iframe,_super),Iframe.prototype.ready=function(){},Iframe.prototype.onData=function(){},Iframe}(Dashing.Widget)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);
return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.Image=function(_super){function Image(){return Image.__super__.constructor.apply(this,arguments)}return __extends(Image,_super),Image.prototype.ready=function(){},Image.prototype.onData=function(){},Image}(Dashing.Widget)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.List=function(_super){function List(){return List.__super__.constructor.apply(this,arguments)}return __extends(List,_super),List.prototype.ready=function(){return this.get("unordered")?$(this.node).find("ol").remove():$(this.node).find("ul").remove()},List}(Dashing.Widget)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.Logo=function(_super){function Logo(){return Logo.__super__.constructor.apply(this,arguments)}return __extends(Logo,_super),Logo.prototype.ready=function(){},Logo.prototype.onData=function(){},Logo}(Dashing.Widget)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.Meter=function(_super){function Meter(){Meter.__super__.constructor.apply(this,arguments),this.observe("value",function(value){return $(this.node).find(".meter").val(value).trigger("change")})}return __extends(Meter,_super),Meter.accessor("value",Dashing.AnimatedValue),Meter.prototype.ready=function(){var meter;return meter=$(this.node).find(".meter"),meter.attr("data-bgcolor",meter.css("background-color")),meter.attr("data-fgcolor",meter.css("color")),meter.knob()},Meter}(Dashing.Widget)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.Notes=function(_super){function Notes(){return Notes.__super__.constructor.apply(this,arguments)}return __extends(Notes,_super),Notes.prototype.ready=function(){},Notes.prototype.onData=function(){},Notes}(Dashing.Widget)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.Number=function(_super){function Number(){return Number.__super__.constructor.apply(this,arguments)}return __extends(Number,_super),Number.accessor("current",Dashing.AnimatedValue),Number.accessor("difference",function(){var current,diff,last;return this.get("last")?(last=parseInt(this.get("last")),current=parseInt(this.get("current")),0!==last?(diff=Math.abs(Math.round((current-last)/last*100)),""+diff+"%"):void 0):""}),Number.accessor("arrow",function(){return this.get("last")?parseInt(this.get("current"))>parseInt(this.get("last"))?"icon-arrow-up":"icon-arrow-down":void 0}),Number.prototype.onData=function(data){return data.status?($(this.get("node")).attr("class",function(i,c){return c.replace(/\bstatus-\S+/g,"")}),$(this.get("node")).addClass("status-"+data.status)):void 0},Number}(Dashing.Widget)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.Positions=function(_super){function Positions(){return Positions.__super__.constructor.apply(this,arguments)}return __extends(Positions,_super),Positions.prototype.ready=function(){},Positions.prototype.onData=function(){},Positions}(Dashing.Widget)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.Text=function(_super){function Text(){return Text.__super__.constructor.apply(this,arguments)}return __extends(Text,_super),Text}(Dashing.Widget)}.call(this),function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.Ticker=function(_super){function Ticker(){return this.nextItem=__bind(this.nextItem,this),Ticker.__super__.constructor.apply(this,arguments)}return __extends(Ticker,_super),Ticker.SPEED=70,Ticker.EASING="linear",Ticker.CSS_ANIMATION=!0,Ticker.FX_INTERVAL=30,Ticker.DELAY=10,Ticker.prototype.getTicker=function(){return $("#news_ticker")},Ticker.prototype.getScrollOrientation=function(){return $(this.node).data("scroll_orientation")?$(this.node).data("scroll_orientation"):"vertical"},Ticker.prototype.initialize=function(){return this.initialized?!0:$(".gridster.ready").length&&this.getTicker().length?(this.log("initializing..."),Ticker.CSS_ANIMATION||"horizontal"!==this.getScrollOrientation()||(this.log("setting jQuery fx interval to "+Ticker.FX_INTERVAL),jQuery.fx.interval=Ticker.FX_INTERVAL,$.fn.transition=$.fn.animate),this.ticker=this.getTicker(),this.log("setting node width to "+$(".gridster.ready").width()),$(this.node).width($(".gridster.ready").width()),this.log("adding wrapper divs"),this.ticker.addClass("newsticker"),this.ticker.wrap('<div class="mask" />'),this.ticker.parent().wrap('<div class="tickercontainer" />'),this.initialized=!0):(this.log("not ready yet..."),!1)},Ticker.prototype.ready=function(){return this.log("ready"),this.doTicker()},Ticker.prototype.onData=function(){return this.log("onData"),this.doTicker()},Ticker.prototype.doTicker=function(){if(this.initialized||this.initialize(),this.initialized){if(this.hasChanged()&&this.hasItems())return this.resetTicker();if(!this.hasItems())return this.stopTicker()}},Ticker.prototype.startTicker=function(){return this.log(""),this.log("starting ticker"),this.should_stop=!1,$(this.node).show(),"horizontal"===this.getScrollOrientation()?this.doHorizontalScroll():this.doVerticalScroll()},Ticker.prototype.doHorizontalScroll=function(){var animationSettings,contentWidth,duration,tickerWidth,viewWidth;return this.log("doing horizontal scroll"),viewWidth=this.ticker.parent().width(),this.log("viewWidth: "+viewWidth),this.insertSpacers(viewWidth),this.log("calculating content width..."),contentWidth=this.contentWidth(),tickerWidth=viewWidth+contentWidth,this.log("setting ticker width to "+tickerWidth),this.ticker.css("width",tickerWidth),this.ticker.css("left",viewWidth),animationSettings={left:-contentWidth},this.log("animating 'left' value from "+viewWidth+" to "+-contentWidth),duration=1e3*tickerWidth/Ticker.SPEED,console.log("duration: "+duration+" ms"),this.ticker.transition(animationSettings,duration,Ticker.EASING,function(_this){return function(){return _this.should_stop?void 0:(_this.log("loop complete, do it again!"),_this.startTicker())}}(this))},Ticker.prototype.doVerticalScroll=function(){var contentHeight;return this.log("doing vertical scroll"),this.itemHeight=this.ticker.children("li").first().outerHeight(),contentHeight=this.itemHeight*this.ticker.children("li").size(),this.ticker.css("height",contentHeight),this.ticker.css("top",this.itemHeight),this.ticker.children("li").width("100%"),this.nextItem()},Ticker.prototype.nextItem=function(){var animationSettings,duration;return this.log("scrolling to next item"),animationSettings={top:this.ticker.position().top-this.itemHeight},duration=1e3,this.ticker.transition(animationSettings,duration,"linear",function(_this){return function(){return _this.should_stop?void 0:(_this.log("comparing "+(_this.ticker.position().top-2)+" to "+-_this.ticker.outerHeight()),_this.ticker.position().top-2>-_this.ticker.outerHeight()?(_this.log("scheduling the next item"),_this.scrollNext=setTimeout(_this.nextItem,1e3*Ticker.DELAY)):(_this.log("loop complete, do it again!"),_this.startTicker()))}}(this))},Ticker.prototype.stopTicker=function(){return this.log("stopping ticker"),this.should_stop=!0,this.ticker&&(this.ticker.stop(!0),clearTimeout(this.scrollNext),this.ticker.removeAttr("style")),$(this.node).hide()},Ticker.prototype.resetTicker=function(){return this.stopTicker(),this.startTicker()},Ticker.prototype.contentWidth=function(){var child,contentWidth,_i,_len,_ref;for(contentWidth=0,_ref=this.ticker.children(),_i=0,_len=_ref.length;_len>_i;_i++)child=_ref[_i],contentWidth+=$(child).outerWidth(!0);return contentWidth},Ticker.prototype.hasItems=function(){return this.get("items")&&this.get("items").length>0},Ticker.prototype.hasChanged=function(){var changed,new_items;return new_items=this.get("items"),changed=!1,this.old_items===new_items?!1:(this.old_items&&!new_items?changed=!0:new_items&&!this.old_items?changed=!0:this.old_items.toString()!==new_items.toString()&&(changed=!0),this.log(changed?"items changed":"items the same"),this.old_items=new_items,changed)},Ticker.prototype.insertSpacers=function(width){return this.log("inserting spacers"),this.ticker.children().not(":last-child").css("margin-right",width)},Ticker.prototype.log=function(){},Ticker}(Dashing.Widget)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.Title=function(_super){function Title(){return Title.__super__.constructor.apply(this,arguments)}return __extends(Title,_super),Title.prototype.ready=function(){},Title.prototype.onData=function(){},Title}(Dashing.Widget)}.call(this),function(){var __hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Dashing.Waittime=function(_super){function Waittime(){return Waittime.__super__.constructor.apply(this,arguments)}return __extends(Waittime,_super),Waittime.prototype.onData=function(){},Waittime}(Dashing.Widget)}.call(this);